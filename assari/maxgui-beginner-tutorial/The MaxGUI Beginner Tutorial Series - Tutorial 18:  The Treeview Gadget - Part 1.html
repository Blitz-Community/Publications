<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0102)http://web.archive.org/web/20061020231821/http://www.2dgamecreators.com/maxgui/T18%20-%20TreeView.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"><script src="./The MaxGUI Beginner Tutorial Series - Tutorial 18:  The Treeview Gadget - Part 1_files/analytics.js" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app200.us.archive.org';v.server_ms=388;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="./The MaxGUI Beginner Tutorial Series - Tutorial 18:  The Treeview Gadget - Part 1_files/bundle-playback.js" charset="utf-8"></script>
<script type="text/javascript" src="./The MaxGUI Beginner Tutorial Series - Tutorial 18:  The Treeview Gadget - Part 1_files/wombat.js" charset="utf-8"></script>
<script type="text/javascript">
  __wm.init("http://web.archive.org/web");
  __wm.wombat("http://www.2dgamecreators.com:80/maxgui/T18%20-%20TreeView.html","20061020231821","http://web.archive.org/","web","/_static/",
	      "1161386301");
</script>
<link rel="stylesheet" type="text/css" href="./The MaxGUI Beginner Tutorial Series - Tutorial 18:  The Treeview Gadget - Part 1_files/banner-styles.css">
<link rel="stylesheet" type="text/css" href="./The MaxGUI Beginner Tutorial Series - Tutorial 18:  The Treeview Gadget - Part 1_files/iconochive.css">
<!-- End Wayback Rewrite JS Include -->






















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  




















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <title>Tutorial 18: The Treeview Gadget Part 1</title>
</head>


<body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
</style>
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display: block; direction: ltr;">
</div><div id="wm-ipp-print">The Wayback Machine - http://web.archive.org/web/20061020231821/http://www.2dgamecreators.com:80/maxgui/T18%20-%20TreeView.html</div>
<div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="./The MaxGUI Beginner Tutorial Series - Tutorial 18:  The Treeview Gadget - Part 1_files/donate.html" scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><script type="text/javascript">
__wm.bt(650,27,25,2,"web","http://www.2dgamecreators.com/maxgui/T18 - TreeView.html","20061020231821",1996,"/_static/",["/_static/css/banner-styles.css?v=omkqRugM","/_static/css/iconochive.css?v=qtvMKcIJ"], "False");
  __wm.rw(1);
</script>
<!-- END WAYBACK TOOLBAR INSERT -->





















<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="font-weight: bold;">The MaxGUI Beginner Tutorial
Series - Tutorial 18:&nbsp;</span></span></span> <span style="font-family: Tahoma;"><span style="font-weight: bold;">The Treeview Gadget - Part 1</span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="font-weight: bold;"> </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="font-weight: bold;"></span><br style="font-weight: bold;">





















(c) Assari Feb 21 2006<br>





















<br>





The treeview gadget is another common gadget used in all sorts of
applications. For example the MaxIDE uses this gadget to display the function lists
and debug information.<br>





<br>





The thing about a treeview gadget is that it always requires a root to
start. You can then start to add nodes to this root. The nodes can have
other nodes attached to it. Imagine how the treeview in the Windows
File Explorer behaves.<br>





<br>





In fact I am going to use the File Explorer as the teaching metaphor to introduce you to the wonders of the treeview gadget.<br>





</span></span>
<ol style="font-family: Tahoma;" id="mozToc">


<!--mozToc h2 1 h2 2 h3 3 h4 4 h5 5 h6 6--><li><a href="http://web.archive.org/web/20061020231821/http://www.2dgamecreators.com/maxgui/T18%20-%20TreeView.html#mozTocId867129">Creating a TextView Gadget using CreateTreeView </a></li>


  <li><a href="http://web.archive.org/web/20061020231821/http://www.2dgamecreators.com/maxgui/T18%20-%20TreeView.html#mozTocId630618">Adding Nodes&nbsp;to the TreeView Gadget using AddTreeViewNode</a></li>


  <li><a href="http://web.archive.org/web/20061020231821/http://www.2dgamecreators.com/maxgui/T18%20-%20TreeView.html#mozTocId331974">Expanding and Collapsing TreeView Nodes</a></li>


</ol>






<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">







</span></span>
<h2><a class="mozTocH2" name="mozTocId867129"></a><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><small><span style="font-weight: bold;">Creating a TextView Gadget using CreateTreeView</span></small> </span></span></h2>






<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"></span></span>
<table style="text-align: left; width: 712px; height: 55px;" border="0" cellpadding="2" cellspacing="2">
















  <tbody>
















    <tr>
















      <td align="undefined" valign="undefined"></td>
















      <td style="background-color: rgb(204, 255, 255); font-family: Tahoma;">Function CreateTreeView:TGadget(x,y,w,h,group:TGadget,style=0)</td>
















      <td align="undefined" valign="undefined"></td>
















    </tr>
















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>





<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><br>





A very simple start to this Gadget will be as follows:-<br>













</span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"></span></span>
<table style="text-align: left; width: 732px; height: 160px;" border="0" cellpadding="2" cellspacing="2">





















  <tbody>





















    <tr>





















      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(1, 81, 107); color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">SuperStrict<br>















      <br>













      <span style="color: rgb(255, 255, 255);"></span>Local <span style="color: rgb(255, 255, 255);">MyWindow:TGadget</span>=CreateWindow(<span style="color: rgb(51, 255, 51);">"TreeView Example"</span><span style="color: rgb(255, 255, 255);">, 40,40,400,400)</span><br>















Global <span style="color: rgb(255, 255, 255);">MyTreeView:TGadget</span>=CreateTreeView<span style="color: rgb(255, 255, 255);">(5,0,200,360,MyWindow)</span><br>















      <br>















Repeat<br>















&nbsp; WaitEvent()<br>















&nbsp; Select EventID()<br>















&nbsp; Case <span style="color: rgb(255, 255, 255);">EVENT_WINDOWCLOSE</span><br>















&nbsp;&nbsp;&nbsp;&nbsp; End<br>













&nbsp; End Select<br>













Forever<br>















End<br>















      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span><span style="color: rgb(255, 255, 102);"></span></span></span></td>





















      <td align="undefined" valign="undefined"></td>





















    </tr>





















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>





















<br>





















<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">Unlike some other CreateGadget function, this one does not do anything much:)<br>





















<br>





















</span></span>
<table style="text-align: left; width: 342px; height: 259px;" border="0" cellpadding="2" cellspacing="2">





















  <tbody>





















    <tr>





















      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><img style="width: 400px; height: 400px;" alt="" src="./The MaxGUI Beginner Tutorial Series - Tutorial 18:  The Treeview Gadget - Part 1_files/t17-01.jpg"><br>





















      </span></span></td>





















      <td align="undefined" valign="undefined"><br>





















      </td>





















    </tr>





















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













<h2><a class="mozTocH2" name="mozTocId630618"></a><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><small><small><span style="font-weight: bold;">Adding Nodes&nbsp;to the TreeView Gadget using AddTreeViewNode</span></small></small></span></span></h2>






<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">


</span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">What
we are going to do now is to read in the files (or folders) in the
BlitzMax installed directory and add those to our TreeView via the <span style="font-weight: bold;">AddTreeViewNode</span> function.<br>





&nbsp;</span></span><br>





<table style="text-align: left; width: 732px; height: 160px;" border="0" cellpadding="2" cellspacing="2">





















  <tbody>





















    <tr>





















      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(1, 81, 107); color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">SuperStrict<br>















      <br>













      <span style="color: rgb(255, 255, 255);"></span>Local <span style="color: rgb(255, 255, 255);">MyWindow:TGadget</span>=CreateWindow(<span style="color: rgb(51, 255, 51);">"TreeView Example"</span><span style="color: rgb(255, 255, 255);">, 40,40,400,400)</span><br>















Global <span style="color: rgb(255, 255, 255);">MyTreeView:TGadget</span>=CreateTreeView<span style="color: rgb(255, 255, 255);">(5,0,200,360,MyWindow)</span><br>















      <br>





      <span style="font-weight: bold;">Local </span><span style="color: rgb(255, 255, 255); font-weight: bold;">Folder</span><span style="font-weight: bold;">:int=ReadDir</span><span style="color: rgb(255, 255, 255); font-weight: bold;">(BlitzMaxPath())</span><br style="font-weight: bold;">





      <span style="font-weight: bold;">Local </span><span style="color: rgb(255, 255, 255); font-weight: bold;">File</span><span style="font-weight: bold;">:String</span><br style="font-weight: bold;">





      <span style="font-weight: bold;">Repeat</span><br style="font-weight: bold;">





      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(255, 255, 255); font-weight: bold;">File</span><span style="font-weight: bold;">=NextFile</span><span style="color: rgb(255, 255, 255); font-weight: bold;">(Folder)</span><br style="font-weight: bold;">





      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; AddTreeViewNode</span><span style="color: rgb(255, 255, 255); font-weight: bold;">(file,MyTreeView)</span><br style="font-weight: bold;">





      <span style="font-weight: bold;">Until </span><span style="color: rgb(255, 255, 255); font-weight: bold;">File=</span><span style="font-weight: bold;">Null</span><br>





      <br>















Repeat<br>















&nbsp; WaitEvent()<br>















&nbsp; Select EventID()<br>















&nbsp; Case <span style="color: rgb(255, 255, 255);">EVENT_WINDOWCLOSE</span><br>















&nbsp;&nbsp;&nbsp;&nbsp; End<br>













&nbsp; End Select<br>













Forever<br>















End<br>















      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span><span style="color: rgb(255, 255, 102);"></span></span></span></td>





















      <td align="undefined" valign="undefined"></td>





















    </tr>





















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>





<br>












<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">The TreeView is now populated with some items. Not yet recognisable ala File Explorer but already we can see some similarities.<br>





















<br>





















</span></span>
<table style="text-align: left; width: 342px; height: 259px;" border="0" cellpadding="2" cellspacing="2">





















  <tbody>





















    <tr>





















      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><img style="width: 400px; height: 400px;" alt="" src="./The MaxGUI Beginner Tutorial Series - Tutorial 18:  The Treeview Gadget - Part 1_files/t17-02.jpg"><br>





















      </span></span></td>





















      <td align="undefined" valign="undefined"><br>





















      </td>





















    </tr>





















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>





<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">Let us explain a little bit how we are reading the files/folder in. We first need to start with a <span style="font-weight: bold;">ReadDir</span> function which actually will open a directory for reading, in this case the folder where BlitzMax was installed to.<br>





</span></span>
<table style="text-align: left; width: 732px; height: 50px;" border="0" cellpadding="2" cellspacing="2">





















  <tbody>





















    <tr>





















      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(1, 81, 107); color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">Local <span style="color: rgb(255, 255, 255);">Folder</span>:int=ReadDir<span style="color: rgb(255, 255, 255);">(BlitzMaxPath())</span><br style="font-weight: bold;">





      <span style="font-weight: bold;"></span></span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span><span style="color: rgb(255, 255, 102);"></span></span></span></td>





















      <td align="undefined" valign="undefined"></td>





















    </tr>





















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>





<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><br>





The <span style="font-weight: bold;">NextFile</span>
function will allow us to loop through every file/folder in this
directory until we hit a null which denotes the end of the directory
(no more file to read) so we stop</span></span><br>





<table style="text-align: left; width: 732px; height: 109px;" border="0" cellpadding="2" cellspacing="2">





















  <tbody>





















    <tr>





















      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(1, 81, 107); color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">Repeat<br>





&nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 255, 255);">File</span>=NextFile<span style="color: rgb(255, 255, 255);">(Folder)</span><br>





&nbsp;&nbsp;&nbsp; AddTreeViewNode<span style="color: rgb(255, 255, 255);">(file,MyTreeView)</span><br>





Until <span style="color: rgb(255, 255, 255);">File=</span>Null<br>





      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span><span style="color: rgb(255, 255, 102);"></span></span></span></td>





















      <td align="undefined" valign="undefined"></td>





















    </tr>





















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>





<br>





<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">You
will notice however that the items in the TreeView contains items which
we never see in a real File Explorer so we need to filter them out as
follows:-<br>





</span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"></span></span><br>





<table style="text-align: left; width: 732px; height: 109px;" border="0" cellpadding="2" cellspacing="2">





















  <tbody>





















    <tr>





















      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(1, 81, 107); color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">Repeat<br>





&nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 255, 255);">File</span>=NextFile<span style="color: rgb(255, 255, 255);">(Folder)<br>





&nbsp;&nbsp;&nbsp; If File=<span style="color: rgb(51, 255, 51);">".."</span> <span style="color: rgb(255, 255, 102);">Or</span> File="." <span style="color: rgb(255, 255, 102);">Or</span> File=<span style="color: rgb(255, 255, 102);">Null Then</span><br>





&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: rgb(102, 204, 204);">'Do Nothing</span><br>





&nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 255, 102);">Else</span><br>





      </span>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; AddTreeViewNode<span style="color: rgb(255, 255, 255);">(file,MyTreeView)<br>





&nbsp; &nbsp; <span style="color: rgb(255, 255, 102);">EndIf</span><br>





      </span>Until <span style="color: rgb(255, 255, 255);">File=</span>Null<br>





      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span><span style="color: rgb(255, 255, 102);"></span></span></span></td>





















      <td align="undefined" valign="undefined"></td>





















    </tr>





















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>





<br>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">We now have a much cleaner look.<br>




<br>




</span></span>
<table style="text-align: left; width: 342px; height: 259px;" border="0" cellpadding="2" cellspacing="2">





















  <tbody>





















    <tr>





















      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><img style="width: 400px; height: 400px;" alt="" src="./The MaxGUI Beginner Tutorial Series - Tutorial 18:  The Treeview Gadget - Part 1_files/t17-03.jpg"><br>





















      </span></span></td>





















      <td align="undefined" valign="undefined"><br>





















      </td>





















    </tr>





















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>




<br>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">If we look at the syntax for <span style="font-weight: bold;">AddTreeViewNode</span>, we can see that it has an icon parameter.</span></span><br>




<table style="text-align: left; width: 712px; height: 55px;" border="0" cellpadding="2" cellspacing="2">
















  <tbody>
















    <tr>
















      <td align="undefined" valign="undefined"></td>
















      <td style="background-color: rgb(204, 255, 255); font-family: Tahoma;">Function AddTreeViewNode:TGadget( text$,node:TGadget,icon=-1 )</td>
















      <td align="undefined" valign="undefined"></td>
















    </tr>
















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>




<br>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">In
our previous encounters with icons in gadget, we know that we first
have to load an iconstrip and then assign that to the relevant gadget
as follows:-<br>


** Download this bmp and place it in an appropriate location for loading in our program below<br>


</span></span>
<table style="text-align: left; width: 342px; height: 27px;" border="0" cellpadding="2" cellspacing="2">




  <tbody>




    <tr>




      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><img style="width: 192px; height: 16px;" alt="" src="./The MaxGUI Beginner Tutorial Series - Tutorial 18:  The Treeview Gadget - Part 1_files/toolbar.bmp"><br>




      </span></span></td>




    </tr>




  
  
  
  
  </tbody>
</table>


<br>




<table style="text-align: left; width: 834px; height: 563px;" border="0" cellpadding="2" cellspacing="2">





















  <tbody>





















    <tr>





















      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(1, 81, 107); color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">SuperStrict<br>















      <br>













      <span style="color: rgb(255, 255, 255);"></span>Local <span style="color: rgb(255, 255, 255);">MyWindow:TGadget</span>=CreateWindow(<span style="color: rgb(51, 255, 51);">"TreeView Example"</span><span style="color: rgb(255, 255, 255);">, 40,40,400,400)</span><br>















Global <span style="color: rgb(255, 255, 255);">MyTreeView:TGadget</span>=CreateTreeView<span style="color: rgb(255, 255, 255);">(5,0,200,360,MyWindow)</span><br>















      <br>





      Local <span style="color: rgb(255, 255, 255);">Folder</span>:int=ReadDir<span style="color: rgb(255, 255, 255);">(BlitzMaxPath())</span><br>





      Local <span style="color: rgb(255, 255, 255);">File</span>:String<br>




      <br>




      <span style="font-weight: bold;">Local </span><span style="color: rgb(255, 255, 255); font-weight: bold;">IconStrip:</span><span style="font-weight: bold;">TIconStrip=LoadIconStrip(</span><span style="color: rgb(51, 255, 51); font-weight: bold;">"D:\My Documents on E\_Tutorials\toolbar.bmp"</span><span style="font-weight: bold;">)</span><br style="font-weight: bold;">




      <span style="font-weight: bold;">SetGadgetIconStrip</span><span style="color: rgb(255, 255, 255); font-weight: bold;">(MyTreeView, IconStrip)</span><br>




      <br style="font-weight: bold;">





      <span style="font-weight: bold;"></span></span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">Repeat<br>





&nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 255, 255);">File</span>=NextFile<span style="color: rgb(255, 255, 255);">(Folder)<br>





&nbsp;&nbsp;&nbsp; If File=<span style="color: rgb(51, 255, 51);">".."</span> <span style="color: rgb(255, 255, 102);">Or</span> File="." <span style="color: rgb(255, 255, 102);">Or</span> File=<span style="color: rgb(255, 255, 102);">Null Then</span><br>





&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: rgb(102, 204, 204);">'Do Nothing</span><br>





&nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 255, 102);">Else</span><br>





      </span>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; AddTreeViewNode<span style="color: rgb(255, 255, 255);">(file,MyTreeView)<br>





&nbsp; &nbsp; <span style="color: rgb(255, 255, 102);">EndIf</span><br>





      </span>Until <span style="color: rgb(255, 255, 255);">File=</span>Null</span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><br>





      <br>















Repeat<br>















&nbsp; WaitEvent()<br>















&nbsp; Select EventID()<br>















&nbsp; Case <span style="color: rgb(255, 255, 255);">EVENT_WINDOWCLOSE</span><br>















&nbsp;&nbsp;&nbsp;&nbsp; End<br>













&nbsp; End Select<br>













Forever<br>















End</span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"><br>















      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span><span style="color: rgb(255, 255, 102);"></span></span></span></td>





















      <td align="undefined" valign="undefined"></td>





















    </tr>





















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><br>




Notice that the first image from our bitmap is becomes the default icon
as the iconstrip has now been assigned to the gadget. </span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><br>


<br>




</span></span>

















  
















    
















      
<table style="text-align: left; width: 342px; height: 259px;" border="0" cellpadding="2" cellspacing="2">




  <tbody>




    <tr>




      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><img style="width: 400px; height: 400px;" alt="" src="./The MaxGUI Beginner Tutorial Series - Tutorial 18:  The Treeview Gadget - Part 1_files/t17-04.jpg"><br>




      </span></span></td>




    </tr>




  
  
  
  
  </tbody>
</table>




<br>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">To be really clever, we can try and mimic the File Explorer look more by doing something like this:-</span></span><br>




<table style="text-align: left; width: 834px; height: 563px;" border="0" cellpadding="2" cellspacing="2">





















  <tbody>





















    <tr>





















      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(1, 81, 107); color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">SuperStrict<br>















      <br>













      <span style="color: rgb(255, 255, 255);"></span>Local <span style="color: rgb(255, 255, 255);">MyWindow:TGadget</span>=CreateWindow(<span style="color: rgb(51, 255, 51);">"TreeView Example"</span><span style="color: rgb(255, 255, 255);">, 40,40,400,400)</span><br>















Global <span style="color: rgb(255, 255, 255);">MyTreeView:TGadget</span>=CreateTreeView<span style="color: rgb(255, 255, 255);">(5,0,200,360,MyWindow)</span><br>















      <br>





      Local <span style="color: rgb(255, 255, 255);">Folder</span>:int=ReadDir<span style="color: rgb(255, 255, 255);">(BlitzMaxPath())</span><br>





      Local <span style="color: rgb(255, 255, 255);">File</span>:String<br>




      <span style="font-weight: bold;">Local </span><span style="color: rgb(255, 255, 255); font-weight: bold;">FullPath</span><span style="font-weight: bold;">:String</span><br>




      <br>




Local <span style="color: rgb(255, 255, 255);">IconStrip:</span>TIconStrip=LoadIconStrip(<span style="color: rgb(51, 255, 51);">"D:\My Documents on E\_Tutorials\toolbar.bmp"</span>)<br>




SetGadgetIconStrip<span style="color: rgb(255, 255, 255);">(MyTreeView, IconStrip)</span><br>




      <br style="font-weight: bold;">





      <span style="font-weight: bold;"></span></span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">Repeat<br>





&nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 255, 255);">File</span>=NextFile<span style="color: rgb(255, 255, 255);">(Folder)<br>





&nbsp;&nbsp;&nbsp; If File=<span style="color: rgb(51, 255, 51);">".."</span> <span style="color: rgb(255, 255, 102);">Or</span> File="." <span style="color: rgb(255, 255, 102);">Or</span> File=<span style="color: rgb(255, 255, 102);">Null Then</span><br>





&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: rgb(102, 204, 204);">'Do Nothing</span><br>





&nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 255, 102);">Else<br>




&nbsp;<span style="font-weight: bold;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: rgb(255, 255, 255); font-weight: bold;">fullPath</span><span style="font-weight: bold;"> = RealPath</span><span style="color: rgb(255, 255, 255); font-weight: bold;">(BlitzMaxPath()+</span><span style="color: rgb(51, 255, 51); font-weight: bold;">"/"</span><span style="color: rgb(255, 255, 255); font-weight: bold;">+file)</span><br style="font-weight: bold;">




      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; If FileType</span><span style="color: rgb(255, 255, 255); font-weight: bold;">(FullPath)=FILETYPE_DIR </span><span style="font-weight: bold;">Then</span><br style="font-weight: bold;">




      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddTreeViewNode</span><span style="color: rgb(255, 255, 255); font-weight: bold;">(file,MyTreeView,1)</span><br style="font-weight: bold;">




      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Else</span><br style="font-weight: bold;">




      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; AddTreeViewNode</span><span style="color: rgb(255, 255, 255); font-weight: bold;">(file,MyTreeView,0)</span><br style="font-weight: bold;">




      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; EndIf</span><br>




      </span></span><span style="color: rgb(255, 255, 255);">&nbsp; &nbsp; <span style="color: rgb(255, 255, 102);">EndIf</span><br>





      </span>Until <span style="color: rgb(255, 255, 255);">File=</span>Null</span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><br>





      <br>















Repeat<br>















&nbsp; WaitEvent()<br>















&nbsp; Select EventID()<br>















&nbsp; Case <span style="color: rgb(255, 255, 255);">EVENT_WINDOWCLOSE</span><br>















&nbsp;&nbsp;&nbsp;&nbsp; End<br>













&nbsp; End Select<br>













Forever<br>















End</span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"><br>















      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span><span style="color: rgb(255, 255, 102);"></span></span></span></td>





















      <td align="undefined" valign="undefined"></td>





















    </tr>





















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><br>




Using the <span style="font-weight: bold;">FileType</span> function we can&nbsp;check to see whether the file is
a folder or a file. We then attach the correct icon to the treeview
node. Voila, we now have something looking a bit more like file explorer :)</span></span><br>




<br>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"></span></span>

















  
















    
















      
<table style="text-align: left; width: 342px; height: 259px;" border="0" cellpadding="2" cellspacing="2">




  <tbody>




    <tr>




      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><img style="width: 400px; height: 400px;" alt="" src="./The MaxGUI Beginner Tutorial Series - Tutorial 18:  The Treeview Gadget - Part 1_files/t17-05.jpg"><br>




      </span></span></td>




    </tr>




  
  
  
  
  </tbody>
</table>





<br>





<h2><a class="mozTocH2" name="mozTocId331974"></a><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><small><small><span style="font-weight: bold;">Expanding and Collapsing TreeView Nodes</span></small></small></span></span></h2>






<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="font-weight: bold;"></span></span></span>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">We
can repackage our above program a little bit differently by moving some
codes into function to position ourselves for the next step.</span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><br>




<br>




</span></span>
<table style="text-align: left; width: 834px; height: 563px;" border="0" cellpadding="2" cellspacing="2">





















  <tbody>





















    <tr>





















      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(1, 81, 107); color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">SuperStrict<br>















      <br>













      <span style="color: rgb(255, 255, 255);"></span>Local <span style="color: rgb(255, 255, 255);">MyWindow:TGadget</span>=CreateWindow(<span style="color: rgb(51, 255, 51);">"TreeView Example"</span><span style="color: rgb(255, 255, 255);">, 40,40,400,400)</span><br>















Global <span style="color: rgb(255, 255, 255);">MyTreeView:TGadget</span>=CreateTreeView<span style="color: rgb(255, 255, 255);">(5,0,200,360,MyWindow)</span><br>















      <br>




Local <span style="color: rgb(255, 255, 255);">IconStrip:</span>TIconStrip=LoadIconStrip(<span style="color: rgb(51, 255, 51);">"D:\My Documents on E\_Tutorials\toolbar.bmp"</span>)<br>




SetGadgetIconStrip<span style="color: rgb(255, 255, 255);">(MyTreeView, IconStrip)</span><br>




      <br style="font-weight: bold;">





      <span style="font-weight: bold;"></span></span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="color: rgb(255, 255, 255);">EnumFiles(BlitzMaxPath(),MyTreeView)</span><br>





      <br>















Repeat<br>















&nbsp; WaitEvent()<br>















&nbsp; Select EventID()<br>















&nbsp; Case <span style="color: rgb(255, 255, 255);">EVENT_WINDOWCLOSE</span><br>















&nbsp;&nbsp;&nbsp;&nbsp; End<br>













&nbsp; End Select<br>













Forever<br>















End<br>




      <br>



Function <span style="color: rgb(255, 255, 255);">EnumFiles:</span>Int<span style="color: rgb(255, 255, 255);">(Dir:</span>String<span style="color: rgb(255, 255, 255);">, Parent:</span>TGadget)<br>




      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"><br>




&nbsp; Local <span style="color: rgb(255, 255, 255);">Folder</span>:int=ReadDir<span style="color: rgb(255, 255, 255);">(Dir)</span><br>




&nbsp; Local <span style="color: rgb(255, 255, 255);">File</span>:String<br>




&nbsp; Local <span style="color: rgb(255, 255, 255);">FullPath</span>:String<br>




      <br>




      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">&nbsp; Repeat<br>





&nbsp; &nbsp; &nbsp; <span style="color: rgb(255, 255, 255);">File</span>=NextFile<span style="color: rgb(255, 255, 255);">(Folder)<br>





&nbsp; &nbsp; &nbsp; If File=<span style="color: rgb(51, 255, 51);">".."</span> <span style="color: rgb(255, 255, 102);">Or</span> File="." <span style="color: rgb(255, 255, 102);">Or</span> File=<span style="color: rgb(255, 255, 102);">Null Then</span><br>





&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; <span style="color: rgb(102, 204, 204);">'Do Nothing</span><br>





&nbsp; &nbsp; &nbsp; <span style="color: rgb(255, 255, 102);">Else<br>




&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 255, 255);">fullPath</span> = RealPath<span style="color: rgb(255, 255, 255);">(BlitzMaxPath()+</span><span style="color: rgb(51, 255, 51);">"/"</span><span style="color: rgb(255, 255, 255);">+file)</span><br>




&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; If FileType<span style="color: rgb(255, 255, 255);">(FullPath)=FILETYPE_DIR </span>Then<br>




&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddTreeViewNode<span style="color: rgb(255, 255, 255);">(file,MyTreeView,1)</span><br>




&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; Else<br>




&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; AddTreeViewNode<span style="color: rgb(255, 255, 255);">(file,MyTreeView,0)</span><br>




&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; EndIf<br>




      </span></span><span style="color: rgb(255, 255, 255);">&nbsp; &nbsp; &nbsp; <span style="color: rgb(255, 255, 102);">EndIf</span><br>





      </span>&nbsp; Until <span style="color: rgb(255, 255, 255);">File=</span>Null<br>




      <br>




End Function<br>




      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">










      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span><span style="color: rgb(255, 255, 102);"></span></span></span></td>





















      <td align="undefined" valign="undefined"></td>





















    </tr>





















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><br>




Running the above gave us exactly the same answer.</span></span><br>




<br>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"></span></span>

















  
















    
















      
<table style="text-align: left; width: 342px; height: 259px;" border="0" cellpadding="2" cellspacing="2">




  <tbody>




    <tr>




      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><img style="width: 400px; height: 400px;" alt="" src="./The MaxGUI Beginner Tutorial Series - Tutorial 18:  The Treeview Gadget - Part 1_files/t17-05.jpg"><br>




      </span></span></td>




    </tr>




  
  
  
  
  </tbody>
</table>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">&nbsp;</span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="font-weight: bold;"><br>



</span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">Now lets add some code (see text in bold) where, by clicking on the folders we can explore its content just like File Explorer.</span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><br>




<br>




</span></span>
<table style="text-align: left; width: 834px; height: 563px;" border="0" cellpadding="2" cellspacing="2">





















  <tbody>





















    <tr>





















      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(1, 81, 107); color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">SuperStrict<br>















      <br>













      <span style="color: rgb(255, 255, 255);"></span>Local <span style="color: rgb(255, 255, 255);">MyWindow:TGadget</span>=CreateWindow(<span style="color: rgb(51, 255, 51);">"TreeView Example"</span><span style="color: rgb(255, 255, 255);">, 40,40,400,400)</span><br>















Global <span style="color: rgb(255, 255, 255);">MyTreeView:TGadget</span>=CreateTreeView<span style="color: rgb(255, 255, 255);">(5,0,200,330,MyWindow)</span><br>















      <br>




Local <span style="color: rgb(255, 255, 255);">IconStrip:</span>TIconStrip=LoadIconStrip(<span style="color: rgb(51, 255, 51);">"D:\My Documents on E\_Tutorials\toolbar.bmp"</span>)<br>




SetGadgetIconStrip<span style="color: rgb(255, 255, 255);">(MyTreeView, IconStrip)</span><br>




      <br style="font-weight: bold;">





      <span style="font-weight: bold;"></span></span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="color: rgb(255, 255, 255);">EnumFiles(BlitzMaxPath(),MyTreeView)</span><br>





      <br>















Repeat<br>















&nbsp; WaitEvent()<br>















&nbsp; Select EventID()<br>















&nbsp; Case <span style="color: rgb(255, 255, 255);">EVENT_WINDOWCLOSE</span><br>















&nbsp;&nbsp;&nbsp;&nbsp; End<br>



      <br>



      <span style="font-weight: bold;">&nbsp; Case <span style="color: rgb(255, 255, 255);">EVENT_GADGETACTION</span></span><br style="font-weight: bold;">



      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Local <span style="color: rgb(255, 255, 255);">Node</span>:TGadget = SelectedTreeViewNode<span style="color: rgb(255, 255, 255);">(MyTreeView)</span></span><br style="font-weight: bold;">



      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Local <span style="color: rgb(255, 255, 255);">s:</span>String=String<span style="color: rgb(255, 255, 255);">(Node.Context)</span></span><br style="font-weight: bold;">



      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; If <span style="color: rgb(255, 255, 255);">s&gt;</span><span style="color: rgb(51, 255, 51);">""</span></span><br style="font-weight: bold;">



      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 255, 255);">EnumFiles(s,node)</span></span><br style="font-weight: bold; color: rgb(255, 255, 255);">



      <span style="font-weight: bold;"><span style="color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; node.context=</span><span style="color: rgb(51, 255, 51);">""</span></span><br style="font-weight: bold;">



      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; EndIf</span><br style="font-weight: bold;">



      <span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 255, 255);"><span style="color: rgb(255, 255, 102);">ExpandTreeViewNode</span>(node)</span></span><br style="font-weight: bold;">



      <br style="font-weight: bold;">



&nbsp; End Select<br>













Forever<br>















End<br>




      <br>



Function <span style="color: rgb(255, 255, 255);">EnumFiles:</span>Int<span style="color: rgb(255, 255, 255);">(Dir:</span>String<span style="color: rgb(255, 255, 255);">, Parent:</span>TGadget)<br>




      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"><br>




&nbsp; Local <span style="color: rgb(255, 255, 255);">Folder</span>:int=ReadDir<span style="color: rgb(255, 255, 255);">(Dir)</span><br>




&nbsp; Local <span style="color: rgb(255, 255, 255);">File</span>:String<br>




&nbsp; Local <span style="color: rgb(255, 255, 255);">FullPath</span>:String<br>




      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"><br>




      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">&nbsp; Repeat<br>





&nbsp; &nbsp; &nbsp; <span style="color: rgb(255, 255, 255);">File</span>=NextFile<span style="color: rgb(255, 255, 255);">(Folder)<br>





&nbsp; &nbsp; &nbsp; If File=<span style="color: rgb(51, 255, 51);">".."</span> <span style="color: rgb(255, 255, 102);">Or</span> File="." <span style="color: rgb(255, 255, 102);">Or</span> File=<span style="color: rgb(255, 255, 102);">Null Then</span><br>





&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; <span style="color: rgb(102, 204, 204);">'Do Nothing</span><br>





&nbsp; &nbsp; &nbsp; <span style="color: rgb(255, 255, 102);">Else<br>




&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 255, 255);">fullPath</span> = RealPath<span style="color: rgb(255, 255, 255);">(Dir+</span><span style="color: rgb(51, 255, 51);">"/"</span><span style="color: rgb(255, 255, 255);">+file)</span><br>




&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; If FileType<span style="color: rgb(255, 255, 255);">(FullPath)=FILETYPE_DIR </span>Then<br>



&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-weight: bold;">Local <span style="color: rgb(255, 255, 255);">handle:</span>TGadget=</span>AddTreeViewNode<span style="color: rgb(255, 255, 255);">(file,Parent,1)</span><br>



&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="font-weight: bold; color: rgb(255, 255, 255);">handle.context=FullPath</span><span style="color: rgb(255, 255, 255);"></span><br>




&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; Else<br>




&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; AddTreeViewNode<span style="color: rgb(255, 255, 255);">(file,Parent,0)</span><br>




&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; EndIf<br>




      </span></span><span style="color: rgb(255, 255, 255);">&nbsp; &nbsp; &nbsp; <span style="color: rgb(255, 255, 102);">EndIf</span><br>





      </span>&nbsp; Until <span style="color: rgb(255, 255, 255);">File=</span>Null<br>




      <br>




End Function<br>




      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">










      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span><span style="color: rgb(255, 255, 102);"></span></span></span></td>





















      <td align="undefined" valign="undefined"></td>





















    </tr>





















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><br>

With the above code, we can now explore our Blitzmax folder to our
hearts content. Notice how the scrollbars automagically appear when the
content of our treeview grows longer the the gadget height and/or width.</span></span><br>




<br>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"></span></span>

















  
















    
















      
<table style="text-align: left; width: 342px; height: 259px;" border="0" cellpadding="2" cellspacing="2">




  <tbody>




    <tr>




      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><img style="width: 400px; height: 400px;" alt="" src="./The MaxGUI Beginner Tutorial Series - Tutorial 18:  The Treeview Gadget - Part 1_files/t19-03.jpg"><br>




      </span></span></td>




    </tr>




  
  
  
  
  </tbody>
</table>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">&nbsp;</span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="font-weight: bold;"><br>



</span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">Now lets take a look at how we manage to achieve this.</span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><br>




<br>




</span></span>
<table style="text-align: left; width: 834px; height: 462px;" border="0" cellpadding="2" cellspacing="2">





















  <tbody>





















    <tr>





















      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(1, 81, 107); color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"><span style="font-weight: bold;"></span><span style="color: rgb(153, 153, 153);">Function EnumFiles:Int(Dir:String, Parent:TGadget)</span><br style="color: rgb(153, 153, 153);">




      </span></span></span><span style="font-family: Lucida Console; color: rgb(153, 153, 153);"><span style="font-family: Tahoma;"><br>




&nbsp; Local Folder:int=ReadDir(Dir)<br>




&nbsp; Local File:String<br>




&nbsp; Local FullPath:String<br>




      </span><span style="font-family: Tahoma;"><br>




      </span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"><span style="color: rgb(153, 153, 153);">&nbsp; Repeat</span><br style="color: rgb(153, 153, 153);">



      <span style="color: rgb(153, 153, 153);">

&nbsp; &nbsp; &nbsp; File=NextFile</span><span style="color: rgb(255, 255, 255);"><span style="color: rgb(153, 153, 153);">(Folder)</span><br style="color: rgb(153, 153, 153);">



      <span style="color: rgb(153, 153, 153);">

&nbsp; &nbsp; &nbsp; If File=".." Or File="." Or File=Null Then</span><br style="color: rgb(153, 153, 153);">



      <span style="color: rgb(153, 153, 153);">

&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; 'Do Nothing</span><br style="color: rgb(153, 153, 153);">



      <span style="color: rgb(153, 153, 153);">

&nbsp; &nbsp; &nbsp; </span><span style="color: rgb(255, 255, 102);"><span style="color: rgb(153, 153, 153);">Else</span><br style="color: rgb(153, 153, 153);">



      <span style="color: rgb(153, 153, 153);">
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fullPath = RealPath(Dir+"/"+file)</span><br style="color: rgb(153, 153, 153);">



      <span style="color: rgb(153, 153, 153);">
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; If FileType(FullPath)=FILETYPE_DIR Then</span><br>



&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Local <span style="color: rgb(255, 255, 255);">handle:</span>TGadget=AddTreeViewNode<span style="color: rgb(255, 255, 255);">(file,Parent,1)</span><br>



&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 255, 255);">handle.context=FullPath</span><span style="color: rgb(255, 255, 255);"></span><br>




&nbsp;<span style="color: rgb(192, 192, 192);"> &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; Else</span><br style="color: rgb(192, 192, 192);">



      <span style="color: rgb(192, 192, 192);">
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; AddTreeViewNode(file,Parent,0)</span><br style="color: rgb(192, 192, 192);">



      <span style="color: rgb(192, 192, 192);">
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; EndIf</span><br style="color: rgb(192, 192, 192);">




      </span></span><span style="color: rgb(192, 192, 192);">&nbsp; &nbsp; &nbsp; EndIf<br>





      &nbsp; Until File=Null</span><br style="color: rgb(192, 192, 192);">




      <br style="color: rgb(192, 192, 192);">



      <span style="color: rgb(192, 192, 192);">
End Function</span><br>




      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);">










      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span><span style="color: rgb(255, 255, 102);"></span></span></span></td>





















      <td align="undefined" valign="undefined"></td>





















    </tr>





















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><br>



The <span style="font-weight: bold;">AddTreeViewNode</span> function returns a TGadget type which we have named as <span style="font-weight: bold;">handle</span>. The TGadget type has a field call <span style="font-weight: bold;">context</span> which we can use to store the full path of our folder for later use.<br>



</span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="font-weight: bold;"><br>



</span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">
</span></span>
<table style="text-align: left; width: 834px; height: 183px;" border="0" cellpadding="2" cellspacing="2">





















  <tbody>





















    <tr>





















      <td align="undefined" valign="undefined">&nbsp;
&nbsp;</td>





















      <td style="background-color: rgb(1, 81, 107); color: rgb(255, 255, 255);"><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"><span style="font-weight: bold;">&nbsp;</span> Case <span style="color: rgb(255, 255, 255);">EVENT_GADGETACTION</span><br>



&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Local <span style="color: rgb(255, 255, 255);">Node</span>:TGadget = SelectedTreeViewNode<span style="color: rgb(255, 255, 255);">(MyTreeView)</span><br>



&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Local <span style="color: rgb(255, 255, 255);">s:</span>String=String<span style="color: rgb(255, 255, 255);">(Node.Context)</span><br>



&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; If <span style="color: rgb(255, 255, 255);">s&gt;</span><span style="color: rgb(51, 255, 51);">""</span><br>



&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 255, 255);">EnumFiles(s,node)</span><br style="color: rgb(255, 255, 255);">



      <span style="color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; node.context=</span><span style="color: rgb(51, 255, 51);">""</span><br>



&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; EndIf<br>



&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 255, 255);"><span style="color: rgb(255, 255, 102);">ExpandTreeViewNode</span>(node)</span><br style="font-weight: bold;">



      </span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"><span style="color: rgb(255, 255, 255);"><span style="color: rgb(255, 255, 102);"><span style="font-weight: bold; color: rgb(255, 255, 255);"></span><span style="color: rgb(255, 255, 255);"></span></span></span></span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="color: rgb(255, 255, 102);"></span><span style="color: rgb(255, 255, 102);"></span></span></span></td>





















      <td align="undefined" valign="undefined"></td>





















    </tr>





















  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>




<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><br>



When we double clicked on the treeview item, a GadgetAction event will
be generated. We capture the selected node using the
<span style="font-weight: bold;">SelectedTreeViewNode</span> function and then checks its context field. Note
that the context field holds a generic Object type so we have to cast
it into a string before we can use it as a string variable.<br>



<br>



Remember earlier we had stored the folder path which we can now use to
explore the next level using our EnumFiles function. The context field
is then nulled to signify that we are done exploring this node.<br>



<br>



The <span style="font-weight: bold;">ExpandTreeVewNode</span> function is then called to expand that particular node.<br>



<br>



</span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="font-weight: bold;">Summary</span><br style="font-weight: bold;">














<br>


There are more Treeview related functions to cover which we will do in the next tutorial but for this tutorial we learnt how to<br>














</span></span>
<ul>














  <li><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"></span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">create a treeview gadget using the <span style="font-weight: bold;">CreateTreeView</span> function</span></span></li>














  <li><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">add items (nodes) to the treeview gadget using <span style="font-weight: bold;">AddTreeViewNode</span></span></span></li>


  <li><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">pretty up our treeview with icons using the icon parameter of&nbsp;</span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="font-weight: bold;">AddTreeViewNode</span></span></span></li>


  <li><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">expand&nbsp;nodes using the&nbsp;</span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><span style="font-weight: bold;">ExpandTreeVewNode </span>(note that a similar function called <span style="font-weight: bold;">CollapseTreeViewNode</span> exists as well) </span></span></li>














  <li><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">Use the EVENT_GADGETACTION eventID to capture mouseclicks on the TreeView Gagdet and the <span style="font-weight: bold;">SelectedTreeViewNode</span> function to retrieve the node the user clicked on.<br>














    </span></span></li>














</ul>














<span style="font-family: Lucida Console;"><span style="font-family: Tahoma;">As you can see from the above example, using these functions already allow us to create a rudimentary file explorer example.<br>














<br>














That's all for now. Return to Main <a href="http://web.archive.org/web/20061020231821/http://www.2dgamecreators.com/maxgui/index.html">Index</a>.</span></span><span style="font-family: Lucida Console;"><span style="font-family: Tahoma;"><br style="font-style: italic;">















<br>















</span></span><span style="font-family: Tahoma;">
</span><span style="font-family: Tahoma;"></span>


<!--
     FILE ARCHIVED ON 23:18:21 Oct 20, 2006 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 12:42:08 Oct 03, 2021.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 112.751
  exclusion.robots: 0.203
  exclusion.robots.policy: 0.195
  RedisCDXSource: 21.087
  esindex: 0.011
  LoadShardBlock: 70.465 (3)
  PetaboxLoader3.datanode: 105.723 (4)
  CDXLines.iter: 18.275 (3)
  load_resource: 257.017
  PetaboxLoader3.resolve: 212.652
--></body></html>